# TradeResonance ‚Äî Flask Modular Split

–≠—Ç–æ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π ‚Äî **—Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥-—à–∞–±–ª–æ–Ω** –¥–ª—è —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –º–æ–Ω–æ–ª–∏—Ç–Ω–æ–≥–æ `app.py` –Ω–∞ —É–¥–æ–±–Ω—ã–µ –º–æ–¥—É–ª–∏.
–¶–µ–ª–∏:
- –ß—ë—Ç–∫–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (Blueprints + Services + DB —Å–ª–æ–π).
- –ü—Ä–æ—Å—Ç—ã–µ –ø—Ä–∞–≤–∫–∏ UI (HTMX + Chart.js –ø–æ CDN, `<datalist>` typeahead).
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ–¥ Railway PostgreSQL —á–µ—Ä–µ–∑ `DATABASE_URL`.

> üìå –ü–æ–º–µ—Å—Ç–∏—Ç–µ —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É –∏ HTML –∏–∑ –≤–∞—à–µ–≥–æ `app.py` –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ —Ñ–∞–π–ª—ã –Ω–∏–∂–µ.
> –í–µ–∑–¥–µ –ø–æ–º–µ—á–µ–Ω—ã –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ `# TODO:` –≥–¥–µ –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–Ω–µ—Å—Ç–∏ –≤–∞—à –∫–æ–¥.

---

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
TradeResonance/
‚îú‚îÄ main.py                   # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ (flask run / gunicorn)
‚îú‚îÄ requirements.txt
‚îú‚îÄ .env.example              # –ü—Ä–∏–º–µ—Ä –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
‚îú‚îÄ app/
‚îÇ  ‚îú‚îÄ __init__.py            # App Factory + —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è blueprints
‚îÇ  ‚îú‚îÄ config.py              # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –Ω–∞ –±–∞–∑–µ ENV
‚îÇ  ‚îú‚îÄ db.py                  # –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ PostgreSQL (psycopg2 + –ø—É–ª)
‚îÇ  ‚îú‚îÄ models.py              # SQL-—Å–∫—Ä–∏–ø—Ç—ã/DAO –∏–ª–∏ dataclasses –¥–ª—è —Å—É—â–Ω–æ—Å—Ç–µ–π
‚îÇ  ‚îú‚îÄ services/
‚îÇ  ‚îÇ  ‚îú‚îÄ __init__.py
‚îÇ  ‚îÇ  ‚îú‚îÄ prices_service.py   # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ —Ü–µ–Ω
‚îÇ  ‚îÇ  ‚îú‚îÄ cities_service.py   # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –≥–æ—Ä–æ–¥–æ–≤
‚îÇ  ‚îÇ  ‚îî‚îÄ products_service.py # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤
‚îÇ  ‚îú‚îÄ routes/
‚îÇ  ‚îÇ  ‚îú‚îÄ __init__.py
‚îÇ  ‚îÇ  ‚îú‚îÄ home.py             # –ì–ª–∞–≤–Ω–∞—è/–¥–∞—à–±–æ—Ä–¥
‚îÇ  ‚îÇ  ‚îú‚îÄ prices.py           # CRUD –ø–æ —Ü–µ–Ω–∞–º (HTMX endpoints)
‚îÇ  ‚îÇ  ‚îú‚îÄ cities.py           # CRUD –ø–æ –≥–æ—Ä–æ–¥–∞–º
‚îÇ  ‚îÇ  ‚îî‚îÄ products.py         # CRUD –ø–æ —Ç–æ–≤–∞—Ä–∞–º
‚îÇ  ‚îú‚îÄ templates/
‚îÇ  ‚îÇ  ‚îú‚îÄ base.html           # –ë–∞–∑–æ–≤—ã–π –ª–µ–π–∞—É—Ç + HTMX + Chart.js + datalist
‚îÇ  ‚îÇ  ‚îú‚îÄ index.html          # –ü—Ä–∏–º–µ—Ä –¥–∞—à–±–æ—Ä–¥–∞ (–≥—Ä–∞—Ñ–∏–∫)
‚îÇ  ‚îÇ  ‚îú‚îÄ partials/
‚îÇ  ‚îÇ  ‚îÇ  ‚îú‚îÄ price_rows.html  # –§—Ä–∞–≥–º–µ–Ω—Ç—ã –¥–ª—è htmx swap
‚îÇ  ‚îÇ  ‚îÇ  ‚îî‚îÄ flash.html
‚îÇ  ‚îî‚îÄ static/
‚îÇ     ‚îî‚îÄ js/
‚îÇ        ‚îî‚îÄ app.js           # –ù–µ–±–æ–ª—å—à–∏–µ —Å–∫—Ä–∏–ø—Ç—ã (htmx helpers / chart init)
‚îî‚îÄ README.md
```

---

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç (–ª–æ–∫–∞–ª—å–Ω–æ)

1) **–ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ** –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
```bash
python -m venv .venv && source .venv/bin/activate  # Windows: .venv\Scripts\activate
pip install -r requirements.txt
```

2) **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ**
–°–∫–æ–ø–∏—Ä—É–π—Ç–µ `.env.example` ‚Üí `.env` –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ:
```
FLASK_ENV=development
SECRET_KEY=dev-secret-change-me
DATABASE_URL=postgresql://USER:PASSWORD@HOST:PORT/DBNAME
# –î–ª—è Railway –≤–æ–∑—å–º–∏—Ç–µ –ø–æ–ª–Ω—ã–π URL –≤ –ø–∞–Ω–µ–ª–∏ –ø—Ä–æ–µ–∫—Ç–∞.
```

3) **–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ë–î (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)**
```bash
flask --app main dbcheck
# –î–æ–±–∞–≤—å—Ç–µ —Å–≤–æ–∏ –º–∏–≥—Ä–∞—Ü–∏–∏/DDL –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
```

4) **–ó–∞–ø—É—Å–∫**
```bash
flask --app main run --debug
# –∏–ª–∏
gunicorn -w 2 -b 0.0.0.0:8000 'main:create_app()'
```

---

## –î–µ–ø–ª–æ–π –Ω–∞ Railway

- –í –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è –∑–∞–¥–∞–π—Ç–µ `DATABASE_URL`, `SECRET_KEY`.
- –ö–æ–º–∞–Ω–¥–∞ —Å—Ç–∞—Ä—Ç–∞: `gunicorn -w 2 -b 0.0.0.0:${PORT} 'main:create_app()'`
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–æ—Ä—Ç —á–∏—Ç–∞–µ—Ç–µ –∏–∑ `$PORT` (Railway –∑–∞–¥–∞—ë—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏).

---

## –ì–¥–µ —á—Ç–æ –ª–µ–∂–∏—Ç

- **`app/routes/*.py`** ‚Äî —Ç–æ–ª—å–∫–æ HTTP-—Å–ª–æ–π (Blueprint). –ë–µ–∑ SQL! –í—ã–∑—ã–≤–∞–µ—Ç —Å–µ—Ä–≤–∏—Å—ã.
- **`app/services/*.py`** ‚Äî –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞/–≤–∞–ª–∏–¥–∞—Ü–∏—è. –í—ã–∑—ã–≤–∞–µ—Ç `db.py`.
- **`app/db.py`** ‚Äî —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å PostgreSQL (–ø—É–ª) –∏ –ø—Ä–æ—Å—Ç—ã–µ helper‚Äô—ã –¥–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤.
- **`app/templates/partials/*.html`** ‚Äî HTMX-—Ñ—Ä–∞–≥–º–µ–Ω—Ç—ã –¥–ª—è —á–∞—Å—Ç–∏—á–Ω—ã—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π.
- **`app/static/js/app.js`** ‚Äî –Ω–µ–±–æ–ª—å—à–∏–µ JS-—Ö–µ–ª–ø–µ—Ä—ã (–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≥—Ä–∞—Ñ–∏–∫–æ–≤, UX).

---

## HTMX, Chart.js, `<datalist>`

- **HTMX**: –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `hx-get/hx-post` –Ω–∞ –∫–Ω–æ–ø–∫–∞—Ö/—Ñ–æ—Ä–º–∞—Ö –∏ –≤–æ–∑–≤—Ä–∞—â–∞–π—Ç–µ –∏–∑ —Ä–æ—É—Ç–æ–≤ **partials**.
- **Chart.js**: –¥–∞–Ω–Ω—ã–µ –æ—Ç–¥–∞–≤–∞–π—Ç–µ –∫–∞–∫ JSON —Å —Å–µ—Ä–≤–∏—Å–∞/—Ä–æ—É—Ç–∞, –∞ —Ä–µ–Ω–¥–µ—Ä –≥—Ä–∞—Ñ–∏–∫–∞ ‚Äî –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ.
- **`<datalist>`**: endpoint‚Äô—ã `GET /cities/options`, `GET /products/options` –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç `<option>` —Å–ø–∏—Å–æ–∫.

–°–º. –≥–æ—Ç–æ–≤—ã–µ –ø—Ä–∏–º–µ—Ä—ã –≤ –∫–æ–¥–µ (`routes/*`, `templates/*`, `static/js/app.js`).

---

## –ö–∞–∫ –ø–µ—Ä–µ–Ω–æ—Å–∏—Ç—å —Å—Ç–∞—Ä—ã–π `app.py`

1. –†–∞–∑–¥–µ–ª–∏—Ç–µ –ø–æ –∑–æ–Ω–∞–º –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏:
   - **–ú–∞—Ä—à—Ä—É—Ç—ã** ‚Üí –≤ `app/routes/*.py`
   - **SQL/–¥–∞–Ω–Ω—ã–µ** ‚Üí –≤ `app/db.py` (helpers) –∏ `app/services/*` (–ª–æ–≥–∏–∫–∞)
   - **HTML** ‚Üí –≤ `app/templates/*` (Jinja2), —á–∞—Å—Ç–∏—á–Ω—ã–µ ‚Äî –≤ `templates/partials/*`
2. –í –º–µ—Å—Ç–∞—Ö `# TODO:` –≤—Å—Ç–∞–≤—å—Ç–µ –≤–∞—à—É –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É / SQL.
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ª–æ–∫–∞–ª—å–Ω–æ, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –æ—Å–Ω–æ–≤–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ (CRUD —Ü–µ–Ω, —Ñ–∏–ª—å—Ç—Ä—ã, –¥–∞—à–±–æ—Ä–¥).
