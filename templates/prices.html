{% extends "base.html" %}
{% block content %}
<div class="card shadow-sm">
  <div class="card-body">
    <h5 class="card-title">{{ t('nav_prices') }}</h5>
<form class="row g-2 mb-3" method="get">
  <input type="hidden" name="tab" value="prices">
  <div class="col-md-3">
    <input class="form-control" name="city" placeholder="{{ t('city') }}" value="{{ q_city }}" list="citiesList">
    <datalist id="citiesList">{% for c in cities_list %}<option value="{{ c }}">{% endfor %}</datalist>
  </div>
  <div class="col-md-3">
    <input class="form-control" name="product" placeholder="{{ t('product') }}" value="{{ q_product }}" list="productsList">
    <datalist id="productsList">{% for p in products_list %}<option value="{{ p }}">{% endfor %}</datalist>
  </div>
  <div class="col-md-2">
    <select class="form-select" name="trend">
      <option value="">{{ t('trend') }}</option>
      <option value="up" {% if q_trend=='up' %}selected{% endif %}>{{ t('up') }}</option>
      <option value="down" {% if q_trend=='down' %}selected{% endif %}>{{ t('down') }}</option>
    </select>
  </div>
  <div class="col-md-2">
    <input type="datetime-local" class="form-control" name="from" value="{{ q_from }}">
  </div>
  <div class="col-md-2">
    <input type="datetime-local" class="form-control" name="to" value="{{ q_to }}">
  </div>
  <div class="col-12">
    <button class="btn btn-primary btn-sm" type="submit">{{ t('filters') }}</button>
  </div>
</form>

    {% if not entries %}
      <p class="text-muted">{{ t('no_data') }}</p>
    {% else %}
    <div class="table-responsive">
      <table class="table table-sm table-striped align-middle">
        <thead>
          <tr>
            <th>ID</th>
            <th>{{ t('city') }}</th>
            <th>{{ t('product') }}</th>
            <th>{{ t('price') }}</th>
            <th>{{ t('trend') }}</th>
            <th>{{ t('percent') }} %</th>
            <th>{{ t('is_prod_city') }}</th>
            <th>Created</th><th>Updated</th><th>{{ t('actions') }}</th>
          </tr>
        </thead>
        <tbody>
          {% for e in entries %}
          <tr>
            <td>{{ e.id }}</td>
            <td>{{ e.city }}</td>
            <td>{{ e.product }}</td>
            <td>{{ '%.0f' % e.price }}</td>
            <td>{{ t(e.trend) }}</td>
            <td>{{ '%.0f' % e.percent }}</td>
            <td>{{ t('yes') if e.is_production_city else t('no') }}</td>
            <td>{{ e.created_at.strftime("%Y-%m-%d %H:%M") }}</td><td>{{ (e.updated_at or e.created_at).strftime("%Y-%m-%d %H:%M") }}</td><td><a class="btn btn-sm btn-primary" href="{{ url_for('edit_entry', entry_id=e.id, lang=lang) }}">{{ t('edit') }}</a></td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
    {% endif %}
  </div>
</div>
{% endblock %}
